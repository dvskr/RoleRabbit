# ============================================================================
# RoleRabbit Environment Configuration
# Section 4.1: Environment Configuration (DB-081 to DB-090)
# ============================================================================
# Copy this file to .env and fill in the values
# DO NOT commit .env to version control
# ============================================================================

# ============================================================================
# Database Configuration (DB-081)
# ============================================================================

# Supabase Database URL
NEXT_PUBLIC_SUPABASE_URL=https://your-project.supabase.co
NEXT_PUBLIC_SUPABASE_ANON_KEY=your-anon-key-here
SUPABASE_SERVICE_ROLE_KEY=your-service-role-key-here

# Direct PostgreSQL Connection (for migrations and admin tasks)
DB_HOST=db.your-project.supabase.co
DB_PORT=5432
DB_NAME=postgres
DB_USER=postgres
DB_PASSWORD=your-database-password

# Connection Pool Settings (DB-089)
DB_POOL_MIN=10
DB_POOL_MAX=50

# ============================================================================
# Storage & CDN Configuration (DB-082)
# ============================================================================

# Supabase Storage
NEXT_PUBLIC_SUPABASE_STORAGE_URL=https://your-project.supabase.co/storage/v1
SUPABASE_STORAGE_BUCKET=portfolios

# CDN Configuration (if using external CDN)
CDN_URL=https://cdn.yourdomain.com
CDN_ENABLED=false

# AWS S3 (Optional - for backups or alternative storage)
AWS_ACCESS_KEY_ID=your-access-key
AWS_SECRET_ACCESS_KEY=your-secret-key
AWS_REGION=us-east-1
AWS_S3_BUCKET=rolerabbit-backups

# ============================================================================
# DNS & Domain Configuration (DB-083)
# ============================================================================

# DNS Provider
DNS_PROVIDER=cloudflare
# Options: cloudflare, route53, custom

# Cloudflare Configuration
CLOUDFLARE_API_TOKEN=your-cloudflare-api-token
CLOUDFLARE_ZONE_ID=your-zone-id
CLOUDFLARE_ACCOUNT_ID=your-account-id

# AWS Route53 Configuration (if using Route53)
# AWS_ROUTE53_HOSTED_ZONE_ID=your-hosted-zone-id

# Base Domain (DB-084)
BASE_DOMAIN=rolerabbit.com
# Subdomains will be: {user}.rolerabbit.com

# ============================================================================
# SSL/TLS Configuration (DB-085)
# ============================================================================

# Let's Encrypt for SSL Certificates
SSL_PROVIDER=letsencrypt
LETSENCRYPT_EMAIL=admin@rolerabbit.com
LETSENCRYPT_STAGING=false
# Set to true for testing to avoid rate limits

# Certificate Storage
SSL_CERT_STORAGE_PATH=./certs
# Or use S3: s3://bucket-name/certs

# ============================================================================
# Redis Configuration (DB-086)
# ============================================================================

# Upstash Redis (for caching and job queue)
UPSTASH_REDIS_REST_URL=https://your-redis.upstash.io
UPSTASH_REDIS_REST_TOKEN=your-redis-token

# Redis Connection String (alternative)
REDIS_URL=redis://default:password@your-redis.upstash.io:6379

# Cache Settings
REDIS_CACHE_TTL=3600
# Default cache TTL in seconds (1 hour)

REDIS_ENABLE_CACHE=true

# ============================================================================
# IP Geolocation Service (DB-087)
# ============================================================================

# IP Geolocation API (for analytics)
IP_GEOLOCATION_PROVIDER=ipapi
# Options: ipapi, maxmind, ipstack

# IPapi Configuration
IPAPI_KEY=your-ipapi-key

# MaxMind Configuration (if using MaxMind)
# MAXMIND_LICENSE_KEY=your-maxmind-license-key
# MAXMIND_ACCOUNT_ID=your-account-id

# IPStack Configuration (if using IPStack)
# IPSTACK_ACCESS_KEY=your-ipstack-key

# ============================================================================
# Timeout Configuration (DB-088)
# ============================================================================

# API Request Timeouts (in milliseconds)
API_TIMEOUT=90000
# Default: 90 seconds

DEPLOYMENT_TIMEOUT=300000
# Default: 5 minutes for deployment operations

# Database Query Timeout
DB_STATEMENT_TIMEOUT=30000
# Default: 30 seconds

# External Service Timeouts
EXTERNAL_SERVICE_TIMEOUT=10000
# Default: 10 seconds

# ============================================================================
# Backup Configuration (DB-090)
# ============================================================================

# Backup Storage
BACKUP_DIR=./backups/database
BACKUP_RETENTION_DAYS=30

# S3 Backup Settings
ENABLE_S3_UPLOAD=false
BACKUP_S3_BUCKET=rolerabbit-db-backups
BACKUP_S3_REGION=us-east-1

# Backup Notifications
ENABLE_BACKUP_NOTIFICATIONS=false
BACKUP_NOTIFICATION_WEBHOOK=https://hooks.slack.com/services/YOUR/WEBHOOK/URL

# ============================================================================
# Application Configuration
# ============================================================================

# Environment
NODE_ENV=development
# Options: development, staging, production

NEXT_PUBLIC_APP_URL=http://localhost:3000

# ============================================================================
# Authentication & Security
# ============================================================================

# JWT Secret
JWT_SECRET=your-secret-key-change-in-production

# Session Settings
SESSION_SECRET=your-session-secret-change-in-production
SESSION_MAX_AGE=604800
# Default: 7 days in seconds

# CORS Settings
CORS_ORIGIN=http://localhost:3000,http://localhost:3001
# Comma-separated list of allowed origins

# ============================================================================
# Email Configuration
# ============================================================================

# Email Provider
EMAIL_PROVIDER=resend
# Options: resend, sendgrid, ses

# Resend Configuration
RESEND_API_KEY=your-resend-api-key
FROM_EMAIL=noreply@rolerabbit.com

# SendGrid Configuration (if using SendGrid)
# SENDGRID_API_KEY=your-sendgrid-api-key

# AWS SES Configuration (if using SES)
# AWS_SES_REGION=us-east-1

# ============================================================================
# Analytics & Monitoring
# ============================================================================

# Application Monitoring
SENTRY_DSN=your-sentry-dsn
SENTRY_ENVIRONMENT=development

# Analytics
NEXT_PUBLIC_GA_TRACKING_ID=G-XXXXXXXXXX
NEXT_PUBLIC_PLAUSIBLE_DOMAIN=rolerabbit.com

# ============================================================================
# Feature Flags
# ============================================================================

# Enable/Disable Features
ENABLE_CUSTOM_DOMAINS=true
ENABLE_ANALYTICS=true
ENABLE_SHARE_LINKS=true
ENABLE_PDF_EXPORT=true
ENABLE_AI_GENERATION=true

# ============================================================================
# External Services
# ============================================================================

# OpenAI for AI Generation
OPENAI_API_KEY=your-openai-api-key
OPENAI_MODEL=gpt-4
OPENAI_MAX_TOKENS=2000

# Stripe for Payments
STRIPE_PUBLISHABLE_KEY=pk_test_your-publishable-key
STRIPE_SECRET_KEY=sk_test_your-secret-key
STRIPE_WEBHOOK_SECRET=whsec_your-webhook-secret

# ============================================================================
# Logging
# ============================================================================

# Log Level
LOG_LEVEL=info
# Options: error, warn, info, debug, trace

# Log Format
LOG_FORMAT=json
# Options: json, pretty

# ============================================================================
# Performance & Optimization
# ============================================================================

# Image Optimization
NEXT_PUBLIC_IMAGE_DOMAINS=supabase.co,your-project.supabase.co,cdn.yourdomain.com

# Build Optimization
NEXT_TELEMETRY_DISABLED=1
ANALYZE_BUNDLE=false

# ============================================================================
# Development Tools
# ============================================================================

# Debug Mode
DEBUG=false
VERBOSE_LOGS=false

# Testing
TEST_DATABASE_URL=postgresql://postgres:password@localhost:5432/rolerabbit_test

# ============================================================================
# Deployment
# ============================================================================

# Vercel (if deploying to Vercel)
# VERCEL_URL=auto-populated-by-vercel
# VERCEL_ENV=development

# Docker
DOCKER_BUILDKIT=1

# ============================================================================
# Scheduled Jobs
# ============================================================================

# Cron Job Configuration
ENABLE_CRON_JOBS=true

# Job Schedule (cron syntax)
BACKUP_CRON=0 2 * * *
# Daily at 2 AM

CLEANUP_CRON=0 3 * * *
# Daily at 3 AM

ANALYTICS_REFRESH_CRON=0 * * * *
# Hourly

# ============================================================================
# Rate Limiting
# ============================================================================

# API Rate Limits
RATE_LIMIT_MAX_REQUESTS=100
RATE_LIMIT_WINDOW_MS=900000
# 100 requests per 15 minutes

# Deployment Rate Limits
DEPLOYMENT_RATE_LIMIT=10
# Max deployments per hour per user

# ============================================================================
# Notes
# ============================================================================
# 1. Never commit this file with real credentials
# 2. Use different values for development, staging, and production
# 3. Keep secrets secure using a secret manager in production
# 4. Rotate credentials regularly
# 5. Use least-privilege principle for all API keys and tokens
